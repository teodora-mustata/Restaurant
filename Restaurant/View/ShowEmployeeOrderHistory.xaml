<Window x:Class="Restaurant.View.ShowEmployeeOrderHistory"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Restaurant.View"
        xmlns:helpers="clr-namespace:Restaurant"
        mc:Ignorable="d"
        Title="ShowEmployeeOrderHistory" Height="700" Width="1000">
    <Window.Resources>
        <helpers:OrderItemToTextConverter x:Key="OrderItemToTextConverter" />
        <helpers:OrderItemsToTextConverter x:Key="OrderItemsToTextConverter" />
        <helpers:UserFromIdConverter x:Key="UserFromIdConverter"/>
    </Window.Resources> 
    <Grid Margin="10">
        <TabControl>
            <TabItem Header="Active Orders">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <ListView Grid.Row="0"
                              ItemsSource="{Binding ActiveOrders}"
                              SelectedItem="{Binding SelectedOrder}"
                              Margin="0,0,0,10">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Order ID"   Width="60"  DisplayMemberBinding="{Binding OrderID}" />
                                <GridViewColumn Header="Client Info" Width="150">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding ClientID, Converter={StaticResource UserFromIdConverter}}" TextWrapping="Wrap"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Header="Date"        Width="150" DisplayMemberBinding="{Binding DatePlaced}" />
                                <GridViewColumn Header="ETA"         Width="150" DisplayMemberBinding="{Binding EstimatedDeliveryTime}" />
                                <GridViewColumn Header="Total"       Width="100">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding TotalPrice, StringFormat={}{0:0.00} lei}" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Header="Status"      Width="100" DisplayMemberBinding="{Binding Status}" />
                                <GridViewColumn Header="Items"       Width="230">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Items, Converter={StaticResource OrderItemsToTextConverter}}"
                                                       TextWrapping="Wrap"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView>

                    <StackPanel Grid.Row="1" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="Change status to:" VerticalAlignment="Center" Margin="5"/>
                        <ComboBox Width="150"
                                  ItemsSource="{Binding StatusValues}"
                                  SelectedItem="{Binding SelectedStatus, Mode=TwoWay}"/>
                        <Button Content="Update Status"
                                Command="{Binding UpdateStatusCommand}"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <TabItem Header="All Orders">
                <ListView ItemsSource="{Binding AllOrders}">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Order ID"   Width="60"  DisplayMemberBinding="{Binding OrderID}" />
                            <GridViewColumn Header="Client Info" Width="150">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding ClientID, Converter={StaticResource UserFromIdConverter}}" TextWrapping="Wrap"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Date"        Width="150" DisplayMemberBinding="{Binding DatePlaced}" />
                            <GridViewColumn Header="ETA"         Width="150" DisplayMemberBinding="{Binding EstimatedDeliveryTime}" />
                            <GridViewColumn Header="Total"       Width="100">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding TotalPrice, StringFormat={}{0:0.00} lei}" />
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Status"      Width="100" DisplayMemberBinding="{Binding Status}" />
                            <GridViewColumn Header="Items"       Width="230">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Items, Converter={StaticResource OrderItemsToTextConverter}}"
                                                   TextWrapping="Wrap"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                        </GridView>
                    </ListView.View>
                </ListView>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
