<Window x:Class="Restaurant.View.EditBundlesWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Restaurant.View"
        mc:Ignorable="d"
        Title="EditBundlesWindow" Height="800" Width="800">
    <Grid>
        <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

        <ListBox ItemsSource="{Binding AllBundles}"
                SelectedItem="{Binding SelectedBundle, Mode=TwoWay}"
                Grid.Row="0" Margin="10">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Image Source="{Binding ImagePath}" Width="100" Height="100" Margin="5"/>
                        <StackPanel Margin="5">
                            <TextBlock Text="{Binding Name}" FontWeight="Bold" />
                            <TextBlock Text="{Binding Price, StringFormat='Price: {0:0.00} lei'}"/>
                            <TextBlock Text="{Binding Category.Name, StringFormat='Category: {0}'}"/>
                            <TextBlock Text="Products: "/>
                            <ItemsControl ItemsSource="{Binding BundleProducts}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock>
                                        <Run Text="{Binding Product.Name}" />
                                        <Run Text="(" />
                                        <Run Text="{Binding Quantity}" />
                                        <Run Text="g)" />
                                        </TextBlock>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                        </StackPanel>
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <StackPanel Grid.Row="1" Orientation="Vertical" Margin="10,0,10,10">
            <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                <TextBlock Text="Bundle name:" Width="100"/>
                <TextBox Text="{Binding EditableBundle.Name, Mode=TwoWay}" Width="200"/>
                <TextBlock Text="Price:" Margin="10,0,0,0" Width="40"/>
                <TextBlock Text="{Binding EditableBundleDisplayPrice}" Margin="10,0,0,0" Width="50"/>
                <TextBlock Text="Discount:" Margin="10,0,0,0" Width="60"/>
                <TextBlock Text="{Binding DiscountDisplay}" Margin="10,0,0,0" Width="50"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                <TextBlock Text="Category:" Width="60"/>
                <ComboBox ItemsSource="{Binding AllCategories}"
                  SelectedItem="{Binding EditableBundle.Category, Mode=TwoWay}"
                  DisplayMemberPath="Name"
                  Width="200"/>
                <!--<ComboBox ItemsSource="{Binding AllCategories}"
                          SelectedValue="{Binding EditableBundle.Category.CategoryID, Mode=TwoWay}"
                          SelectedValuePath="CategoryID"
                          DisplayMemberPath="Name"
                          Width="200"/>-->
            </StackPanel>

            <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                <TextBlock Text="Products:" Width="80"/>
                <ListBox x:Name="ProductsListBox"
                 ItemsSource="{Binding AllProducts}"
                 SelectedItem="{Binding SelectedProduct, Mode=TwoWay}"
                 DisplayMemberPath="Name"
                 Height="150"
                 Width="300"
                 HorizontalAlignment="Left"/>

                <TextBlock Text="Products in bundle:" Width="120" Margin="10,0,0,0"/>
                <ListBox x:Name="AddedProductsListBox"
                         ItemsSource="{Binding EditableBundle.BundleProducts}"
                         SelectedItem="{Binding SelectedBundleProduct, Mode=TwoWay}"
                         SelectionMode="Single"
                         Height="150"
                         Width="250"
                         HorizontalAlignment="Left">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock>
                            <Run Text="{Binding Product.Name}"/>
                            <Run Text=" - "/>
                            <Run Text="{Binding Quantity}"/>
                            <Run Text="g - "/>
                            <Run Text="{Binding Price, Mode=OneWay, StringFormat={}{0:0.00}}"/>
                            <Run Text="lei"/>
                            </TextBlock>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

            </StackPanel>

            <StackPanel Orientation="Horizontal" Margin="150,0,0,5">
                <TextBlock Text="Quantity per product:" Width="120"/>
                <TextBox Text="{Binding SelectedQuantity , Mode=TwoWay}" Width="50"/>
                <Button Content="Add product to bundle" Width="150" Command="{Binding AddProductToBundleCommand}" Margin="0,0,20,0"/>
                <Button Content="Delete product from bundle" Width="150" Command="{Binding DeleteProductFromBundleCommand}"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                <TextBlock Text="Bundle image:" Width="90"/>
                <Button Content="Select image" Width="150" Command="{Binding SelectImageCommand}" />
                <TextBlock Text="{Binding EditableBundle.ImagePath}" Margin="10,0,0,0"/>
            </StackPanel>
        </StackPanel>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Left" Margin="10,0,0,10">
            <Button Content="Save" Width="80" Margin="0,0,10,0" Command="{Binding SaveBundleCommand}" />
            <Button Content="Delete" Width="80" Margin="0,0,10,0" Command="{Binding DeleteBundleCommand}" />
            <Button Content="Add New Bundle" Width="300" Background="LightGreen" Command="{Binding AddBundleCommand}" FontWeight="Bold" />
        </StackPanel>
    </Grid>
</Window>
